
		TOPPERS/SSPカーネル
		変更履歴

		対応バージョン: Release 1.3.0
		最終更新: 2015年 5月19日

このドキュメントは，TOPPERS/SSPカーネルのRelease 1.0.0以降の変更履歴を，
新しい方から順に記述したものである．

----------------------------------------------------------------------
     TOPPERS/SSP Kernel
         Smallest Set Profile Kernel
 
     Copyright (C) 2011-2013 by Meika Sugimoto
     Copyright (C) 2014,2015 by Naoki Saito
                 Nagoya Municipal Industrial Research Institute, JAPAN
 
 上記著作権者は，以下の(1)〜(4)の条件を満たす場合に限り，本ソフトウェ
 ア（本ソフトウェアを改変したものを含む．以下同じ）を使用・複製・改
 変・再配布（以下，利用と呼ぶ）することを無償で許諾する．
 (1) 本ソフトウェアをソースコードの形で利用する場合には，上記の著作
     権表示，この利用条件および下記の無保証規定が，そのままの形でソー
     スコード中に含まれていること．
 (2) 本ソフトウェアを，ライブラリ形式など，他のソフトウェア開発に使
     用できる形で再配布する場合には，再配布に伴うドキュメント（利用
     者マニュアルなど）に，上記の著作権表示，この利用条件および下記
     の無保証規定を掲載すること．
 (3) 本ソフトウェアを，機器に組み込むなど，他のソフトウェア開発に使
     用できない形で再配布する場合には，次のいずれかの条件を満たすこ
     と．
   (a) 再配布に伴うドキュメント（利用者マニュアルなど）に，上記の著
       作権表示，この利用条件および下記の無保証規定を掲載すること．
   (b) 再配布の形態を，別に定める方法によって，TOPPERSプロジェクトに
       報告すること．
 (4) 本ソフトウェアの利用により直接的または間接的に生じるいかなる損
     害からも，上記著作権者およびTOPPERSプロジェクトを免責すること．
     また，本ソフトウェアのユーザまたはエンドユーザからのいかなる理
     由に基づく請求からも，上記著作権者およびTOPPERSプロジェクトを
     免責すること．
 
 本ソフトウェアは，無保証で提供されているものである．上記著作権者お
 よびTOPPERSプロジェクトは，本ソフトウェアに関して，特定の使用目的
 に対する適合性も含めて，いかなる保証も行わない．また，本ソフトウェ
 アの利用により直接的または間接的に生じたいかなる損害に関しても，そ
 の責任を負わない．
 
----------------------------------------------------------------------

		TOPPERS/SSPカーネル
		Release 1.2.1 から 1.3.0 への変更点

・サービスコール ista_alm, istp_alm を追加
・char_t 型の廃止
・シリアルドライバの変更
	・serial_wri_dat, serial_rea_dat の排他制御区間と排他制御方法に関する修正
	・serial_wri_dat のバッファフル時の挙動に関する修正
	・serial_rea_dat でバッファエンプティ時の挙動に関する修正
・OMIT_INITIALIZE_EXCEPTION 定義済みの場合にリンクエラーとなる問題の修正

・(toppers-users 4235) の指摘事項への対応(kernel.tf の行頭$直後の空白抜け)
・(toppers-users 4245)の指摘事項への対応(ARM向けgccオプションの追加)
・周期ハンドラ，アラームハンドラの最大個数を示す構成マクロの定義
・doc/configurator.txt の共有スタックに関する記述ミスの修正．
・task.c の重複するプロトタイプ宣言の削除
・リネームファイルの重複エントリの削除
・call_almhdr (alarm.c) の引数の型を uintptr_t へ変更

・sample1 アプリにおけるシステムログのマスク設定に関する修正(ログタスクの初期化処理呼び出し追加)
・sample1.c の SVC マクロで行番号が正しく表示されない問題の修正
・hello_world.c の task シリアルポートのオープン処理の追加
・hello_world.c のメッセージ表示用マクロの修正

・arm_m_gcc ターゲット依存部の prc_terminate への NoReturn 属性追加
・cq_frk_fm3_gccターゲット依存部の hardware_init_hook (prc_support.S) に function 属性の設定追加

・MISRA-Cルールに基く変更
	・符号なし整数定数へ接尾語の付加
	・initialize_eventflag でループ変数 i の型を uint_t から int_t に変更
	・syslog_print の switch に default 節を追加．
	・serial_initialize, serial_terminate の for文でループカウンタのみを使用するように変更
	・serial_rea_dat で符号の異なる型への代入箇所を修正
	・target_timer_handler で戻り値を使用しない関数呼び出しをvoidでキャストした．
	・sample1.c のforの本体を複合文に変更し，コメント追加

○ターゲット依存部の要修正箇所（1.2.1 → 1.3.0）

(1) char_t の廃止に伴い，char_t を char に変更する

----------------------------------------------------------------------

		TOPPERS/SSPカーネル
		Release 1.2.0 から 1.2.1 への変更点

・CRE_FLG の iflgptn に対するチェック追加およびエラー条件を変更
・イベントフラグのビットパターンに対するビット数定義を追加
・dequeue_data関数の引数型指定抜けの修正
・(toppers-users 4129)で指摘事項の修正
    ・sample1 の修正
    ・enqueue_data, dequeue_data を static 関数から通常の関数へ変更
    ・Makefile.kernel の修正
・sample1 のアプリの説明文をsample1.c のコメントとして追加
・システムコンフィギュレーションファイルで serial.cfg を INCLUDE しない
  場合に TARGET_NAME が未定義となる問題の修正(banner.tf)

○ターゲット依存部の要修正箇所（1.2.0 → 1.2.1）
    ターゲット依存部への影響はないため，修正は不要である．

----------------------------------------------------------------------

		TOPPERS/SSPカーネル
		Release 1.1.1 から 1.2.0 への変更点

・タスク起動要求キューイングのサポート
  タスク起動要求を1回までキューイングするように修正．

・DEF_STKの追加

・DEF_ICSの機能修正

・拡張パッケージの追加
  - データキュー機能
  - イベントフラグ機能

・サンプルプログラムの修正
  - タスク終了時のメッセージ出力修正
  - データキューのテスト機能の追加
  - イベントフラグのテスト機能の追加


○ターゲット依存部の要修正箇所（1.1.1 → 1.2.0）

(1) TEST_EXCマクロの削除に伴い，CPUEXC1マクロを条件コンパイルに使用するように
    変更する．

(2) サンプルプログラムにdataqueue.c，eventflag.cをビルド対象に含めるように変更．
    (Makefileを使用しないターゲット依存部のみ)

(3) 無限ループの実装方法を（TOPPERS_assert_abort，target_exitなど）tecsgenで
    解釈できる記述方法に変更する．

----------------------------------------------------------------------

		TOPPERS/SSPカーネル
		Release 1.1.0 から 1.1.1 への変更点

・カーネルバージョンマクロの修正
  (Release1.1.0ではカーネルバージョンマクロの値に誤りがあった）

・実行時優先度を設定しているタスクがact_tsk(TSK_SELF)を呼び出した場合の
  不具合の修正

・ソースコードのリファクタリング
  - task.c/hへのコメント追加、特に初期優先度と実行時優先度の違いの明確j化

・DEF_EPRI，DEF_ICSの仕様定義を追加(doc/original_static_api.txt)
  (ただしTOPPERS統合仕様書1.4.0との一貫性はないため注意）

・システムサービスの追加
  - syslog機能
  - ログ表示タスク機能

・不要ファイルの削除
  - utilsディレクトリ以下の不要なスクリプトの削除
  - confkernelスクリプトに関連したファイルの削除

・utilsディレクトリのスクリプトの修正
  - プロシージャ呼び出しの際のdo文の削除

・サンプルプログラムの機能追加
  - アラームハンドラのテスト機能の追加
  - ログメッセージをsyslog機能を使用して出力するように修正


----------------------------------------------------------------------

		TOPPERS/SSPカーネル
		Release 1.0.0 から 1.1.0 への変更点

・テストプログラムの追加

・割込みサービスルーチンに関するバグフィックス
	- 割込みサービスルーチン生成に必要なターゲット依存部の定義がなかった問題の修正
	  (x_get_ipm, t_get_ipm, i_get_ipm, x_set_ipm, t_set_ipm, i_set_ipmの追加）

・MISRA-Cコーディングスタンダードに対応するためのコード修正

・ターゲット依存部とのインターフェース修正
	- TOPPERS_SUPPORT_DIS_INTをTOPPERS_TARGET_SUPPORT_DIS_INTに修正
	- TOPPERS_SUPPORT_ENA_INTをTOPPERS_TARGET_SUPPORT_ENA_INTに修正


----------------------------------------------------------------------
